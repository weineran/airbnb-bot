{"paragraphs":[{"text":"/* Import dependencies */\nimport com.mongodb.spark._\nimport com.mongodb.spark.config._\nimport org.bson.Document\n\n/**\n * NOTE TO USER: In your terminal, run \"docker ps\" to see the names of your currently running docker containers.\n * Find the name of the MongoDB container and paste it into the string below.\n */\nval mongoDbContainerName = \"airbnbbot_mongodb_1\" // <- PASTE YOUR MONGODB CONTAINER NAME HERE\nval dbName = \"air_bnb\"\nval collectionName = \"20170601\"\nval mongoDbUri = \"mongodb://\" + mongoDbContainerName + \"/\" + dbName + \".\" + collectionName\n\n","user":"anonymous","dateUpdated":"2017-06-05T00:00:09+0000","config":{"enabled":true,"editorMode":"ace/mode/scala","results":{},"editorSetting":{"language":"scala"},"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport com.mongodb.spark._\n\nimport com.mongodb.spark.config._\n\nimport org.bson.Document\n\nmongoDbContainerName: String = airbnbbot_mongodb_1\n\ndbName: String = air_bnb\n\ncollectionName: String = 20170601\n\nmongoDbUri: String = mongodb://airbnbbot_mongodb_1/air_bnb.20170601\n"}]},"apps":[],"jobName":"paragraph_1496611711993_1178297397","id":"20170604-172329_1884401710","dateCreated":"2017-06-04T21:28:31+0000","dateStarted":"2017-06-05T00:00:10+0000","dateFinished":"2017-06-05T00:00:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:398"},{"text":"/* Get the collection as a Spark dataframe */\nval df = sc.loadFromMongoDB(ReadConfig(Map(\"uri\" -> mongoDbUri))).toDF()\n\n/* The schema is automatically inferred.  Have a look. */\ndf.printSchema()\n\n/* Show the data */\ndf.show()\n","user":"anonymous","dateUpdated":"2017-06-05T00:00:14+0000","config":{"enabled":true,"editorMode":"ace/mode/scala","results":{},"editorSetting":{"language":"scala"},"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- _id: struct (nullable = true)\n |    |-- oid: string (nullable = true)\n |-- listing: struct (nullable = true)\n |    |-- bathrooms: double (nullable = true)\n |    |-- bedrooms: integer (nullable = true)\n |    |-- beds: integer (nullable = true)\n |    |-- city: string (nullable = true)\n |    |-- distance: null (nullable = true)\n |    |-- extra_host_languages: array (nullable = true)\n |    |    |-- element: string (containsNull = true)\n |    |-- id: integer (nullable = true)\n |    |-- instant_bookable: boolean (nullable = true)\n |    |-- is_business_travel_ready: boolean (nullable = true)\n |    |-- is_family_preferred: boolean (nullable = true)\n |    |-- is_new_listing: boolean (nullable = true)\n |    |-- lat: double (nullable = true)\n |    |-- lng: double (nullable = true)\n |    |-- localized_city: string (nullable = true)\n |    |-- name: string (nullable = true)\n |    |-- neighborhood: string (nullable = true)\n |    |-- person_capacity: integer (nullable = true)\n |    |-- picture_count: integer (nullable = true)\n |    |-- picture_url: string (nullable = true)\n |    |-- picture_urls: array (nullable = true)\n |    |    |-- element: string (containsNull = true)\n |    |-- preview_encoded_png: string (nullable = true)\n |    |-- primary_host: struct (nullable = true)\n |    |    |-- first_name: string (nullable = true)\n |    |    |-- picture_url: string (nullable = true)\n |    |    |-- has_profile_pic: boolean (nullable = true)\n |    |    |-- is_superhost: boolean (nullable = true)\n |    |    |-- smart_name: string (nullable = true)\n |    |    |-- thumbnail_url: string (nullable = true)\n |    |    |-- id: integer (nullable = true)\n |    |-- property_type: string (nullable = true)\n |    |-- property_type_id: integer (nullable = true)\n |    |-- public_address: string (nullable = true)\n |    |-- reviews_count: integer (nullable = true)\n |    |-- room_type: string (nullable = true)\n |    |-- room_type_category: string (nullable = true)\n |    |-- scrim_color: string (nullable = true)\n |    |-- star_rating: double (nullable = true)\n |    |-- thumbnail_url: string (nullable = true)\n |    |-- user: struct (nullable = true)\n |    |    |-- first_name: string (nullable = true)\n |    |    |-- picture_url: string (nullable = true)\n |    |    |-- has_profile_pic: boolean (nullable = true)\n |    |    |-- is_superhost: boolean (nullable = true)\n |    |    |-- smart_name: string (nullable = true)\n |    |    |-- thumbnail_url: string (nullable = true)\n |    |    |-- id: integer (nullable = true)\n |    |-- user_id: integer (nullable = true)\n |    |-- xl_picture_url: string (nullable = true)\n |    |-- xl_picture_urls: array (nullable = true)\n |    |    |-- element: string (containsNull = true)\n |-- loc: struct (nullable = true)\n |    |-- type: string (nullable = true)\n |    |-- coordinates: array (nullable = true)\n |    |    |-- element: double (containsNull = true)\n |-- pricing_quote: struct (nullable = true)\n |    |-- available: boolean (nullable = true)\n |    |-- localized_nightly_price: integer (nullable = true)\n |    |-- total_price: integer (nullable = true)\n |    |-- localized_currency: string (nullable = true)\n |    |-- checkin: string (nullable = true)\n |    |-- localized_service_fee: integer (nullable = true)\n |    |-- nightly_price: integer (nullable = true)\n |    |-- guest_details: struct (nullable = true)\n |    |    |-- number_of_infants: integer (nullable = true)\n |    |    |-- number_of_children: integer (nullable = true)\n |    |    |-- number_of_adults: integer (nullable = true)\n |    |-- localized_total_price: integer (nullable = true)\n |    |-- guests: integer (nullable = true)\n |    |-- checkout_dt: timestamp (nullable = true)\n |    |-- service_fee: integer (nullable = true)\n |    |-- duration: integer (nullable = true)\n |    |-- checkin_dt: timestamp (nullable = true)\n |    |-- checkout: string (nullable = true)\n |    |-- listing_currency: string (nullable = true)\n |    |-- long_term_discount_amount_as_guest: integer (nullable = true)\n |-- scrape_date: timestamp (nullable = true)\n |-- viewed_at: null (nullable = true)\n\n\ndf: org.apache.spark.sql.DataFrame = [_id: struct<oid: string>, listing: struct<bathrooms: double, bedrooms: int ... 33 more fields> ... 4 more fields]\n+--------------------+--------------------+--------------------+--------------------+--------------------+---------+\n|                 _id|             listing|                 loc|       pricing_quote|         scrape_date|viewed_at|\n+--------------------+--------------------+--------------------+--------------------+--------------------+---------+\n|[5930410bd526e400...|[1.0,3,3,Chicago,...|[Point,WrappedArr...|[true,390,390,USD...|2017-06-01 16:30:...|     null|\n|[5930410bd526e400...|[2.0,1,1,Chicago,...|[Point,WrappedArr...|[true,53,53,USD,2...|2017-06-01 16:30:...|     null|\n|[5930410bd526e400...|[2.0,1,1,Chicago,...|[Point,WrappedArr...|[true,74,74,USD,2...|2017-06-01 16:30:...|     null|\n|[5930410bd526e400...|[1.0,1,1,Chicago,...|[Point,WrappedArr...|[true,49,49,USD,2...|2017-06-01 16:30:...|     null|\n|[5930410bd526e400...|[1.0,1,1,Chicago,...|[Point,WrappedArr...|[true,61,61,USD,2...|2017-06-01 16:30:...|     null|\n|[5930410bd526e400...|[1.0,0,2,Chicago,...|[Point,WrappedArr...|[true,135,135,USD...|2017-06-01 16:30:...|     null|\n|[5930410bd526e400...|[1.0,2,2,Chicago,...|[Point,WrappedArr...|[true,170,170,USD...|2017-06-01 16:30:...|     null|\n|[5930410bd526e400...|[1.0,1,1,Chicago,...|[Point,WrappedArr...|[true,130,130,USD...|2017-06-01 16:30:...|     null|\n|[5930410bd526e400...|[1.0,1,1,Chicago,...|[Point,WrappedArr...|[true,170,170,USD...|2017-06-01 16:30:...|     null|\n|[5930410bd526e400...|[1.0,2,2,Chicago,...|[Point,WrappedArr...|[true,160,160,USD...|2017-06-01 16:30:...|     null|\n|[5930410bd526e400...|[1.0,1,1,Chicago,...|[Point,WrappedArr...|[true,69,69,USD,2...|2017-06-01 16:30:...|     null|\n|[5930410bd526e400...|[1.0,2,4,Chicago,...|[Point,WrappedArr...|[true,170,170,USD...|2017-06-01 16:30:...|     null|\n|[5930410bd526e400...|[1.0,3,4,Chicago,...|[Point,WrappedArr...|[true,175,175,USD...|2017-06-01 16:30:...|     null|\n|[5930410bd526e400...|[1.0,2,2,Chicago,...|[Point,WrappedArr...|[true,235,235,USD...|2017-06-01 16:30:...|     null|\n|[5930410bd526e400...|[1.0,1,1,Chicago,...|[Point,WrappedArr...|[true,70,70,USD,2...|2017-06-01 16:30:...|     null|\n|[5930410bd526e400...|[1.0,1,1,Chicago,...|[Point,WrappedArr...|[true,89,89,USD,2...|2017-06-01 16:30:...|     null|\n|[5930410bd526e400...|[1.0,1,1,Chicago,...|[Point,WrappedArr...|[true,75,75,USD,2...|2017-06-01 16:30:...|     null|\n|[5930410bd526e400...|[1.0,1,2,Chicago,...|[Point,WrappedArr...|[true,165,165,USD...|2017-06-01 16:30:...|     null|\n|[5930410bd526e400...|[2.0,3,3,Chicago,...|[Point,WrappedArr...|[true,255,255,USD...|2017-06-01 16:30:...|     null|\n|[5930410bd526e400...|[1.0,1,1,Chicago,...|[Point,WrappedArr...|[true,170,170,USD...|2017-06-01 16:30:...|     null|\n+--------------------+--------------------+--------------------+--------------------+--------------------+---------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1496611711995_1177143150","id":"20170604-172340_1122904255","dateCreated":"2017-06-04T21:28:31+0000","dateStarted":"2017-06-05T00:00:14+0000","dateFinished":"2017-06-05T00:00:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:399"},{"text":"/* We can run SQL queries on the collection */\n\n/* Register the dataframe as a temporary table */\ndf.registerTempTable(\"scrapes_20170601\")\n\n/* Run a query and show results */\nval expensiveListings = spark.sql(\"SELECT listing, pricing_quote FROM scrapes_20170601 WHERE pricing_quote.total_price >= 100\")\nexpensiveListings.show()\n","user":"anonymous","dateUpdated":"2017-06-05T00:00:58+0000","config":{"enabled":true,"editorMode":"ace/mode/scala","results":{},"editorSetting":{"language":"scala"},"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\nexpensiveListings: org.apache.spark.sql.DataFrame = [listing: struct<bathrooms: double, bedrooms: int ... 33 more fields>, pricing_quote: struct<available: boolean, localized_nightly_price: int ... 15 more fields>]\n+--------------------+--------------------+\n|             listing|       pricing_quote|\n+--------------------+--------------------+\n|[1.0,3,3,Chicago,...|[true,390,390,USD...|\n|[1.0,0,2,Chicago,...|[true,135,135,USD...|\n|[1.0,2,2,Chicago,...|[true,170,170,USD...|\n|[1.0,1,1,Chicago,...|[true,130,130,USD...|\n|[1.0,1,1,Chicago,...|[true,170,170,USD...|\n|[1.0,2,2,Chicago,...|[true,160,160,USD...|\n|[1.0,2,4,Chicago,...|[true,170,170,USD...|\n|[1.0,3,4,Chicago,...|[true,175,175,USD...|\n|[1.0,2,2,Chicago,...|[true,235,235,USD...|\n|[1.0,1,2,Chicago,...|[true,165,165,USD...|\n|[2.0,3,3,Chicago,...|[true,255,255,USD...|\n|[1.0,1,1,Chicago,...|[true,170,170,USD...|\n|[1.5,2,2,Chicago,...|[true,250,250,USD...|\n+--------------------+--------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1496611711999_1177527899","id":"20170604-201625_532357494","dateCreated":"2017-06-04T21:28:31+0000","dateStarted":"2017-06-05T00:00:58+0000","dateFinished":"2017-06-05T00:01:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:400"},{"text":"%sql\n\n/* Anotherway to run a query */\nSELECT listing.name, pricing_quote.total_price\nFROM scrapes_20170601\nWHERE pricing_quote.total_price >= 100","user":"anonymous","dateUpdated":"2017-06-05T00:01:55+0000","config":{"enabled":true,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"name\ttotal_price\nThe best of Urban Rustic in the center of Logan Sq\t390\nUnique Coach House in Logan Square\t135\nPenthouse Luxury Style Spectacular View Chicago\t170\nPrivate Entrance/Steam Room Ensuite\t130\nIdeal Location in Logan Square 1BR\t170\nVintage Sunny Bungalow Logan Square\t160\nLogan Square Apartment\t170\nSpacious Logan Square Apartment\t175\nHistoric Palmer Square 2BR.  Right on the Park!\t235\nDietlin's B&B - Green Room\t165\n3BR Gut Rehab in Hot Bucktown Area\t255\nLuxury Penthouse Spectacular View Chicago + Sunset\t170\nHideout at the Joinery\t250\n"}]},"apps":[],"jobName":"paragraph_1496611712003_868189783","id":"20170604-210817_2070318329","dateCreated":"2017-06-04T21:28:32+0000","dateStarted":"2017-06-05T00:01:55+0000","dateFinished":"2017-06-05T00:01:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:401"},{"dateUpdated":"2017-06-04T21:28:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1496611712005_865881290","id":"20170604-211355_333538957","dateCreated":"2017-06-04T21:28:32+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:402"}],"name":"Airbnb Exploration","id":"2CH2XJJVA","angularObjects":{"2CMTV4GHP:shared_process":[],"2CHD2BEBB:shared_process":[],"2CJK5A79M:shared_process":[],"2CMA92VRG:shared_process":[],"2CMSYEW4C:shared_process":[],"2CM7QPRVG:shared_process":[],"2CGU5AS6K:shared_process":[],"2CJCQJKT9:shared_process":[],"2CJUZZFH6:shared_process":[],"2CKT6ZPKN:shared_process":[],"2CH76UXRV:shared_process":[],"2CJC2PAJ7:shared_process":[],"2CJNMGZWN:shared_process":[],"2CKGTBH84:shared_process":[],"2CJH536CK:shared_process":[],"2CH5N83QZ:shared_process":[],"2CKRACCYM:shared_process":[],"2CKJV8ERR:shared_process":[],"2CHNUPSX5:shared_process":[],"2CK75FN8E:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}